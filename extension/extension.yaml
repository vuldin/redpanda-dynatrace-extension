name: custom:redpanda.enhanced
version: 1.0.5
minDynatraceVersion: '1.310'
author:
  name: Custom Enhanced Redpanda Extension
prometheus:
- group: latency_metrics
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  subgroups:
  - subgroup: kafka_request_latency
    dimensions:
    - key: redpanda_request
      value: label:redpanda_request
    - key: redpanda_server
      value: label:redpanda_server
    metrics:
    - key: redpanda.kafka.request.latency.seconds.sum
      value: metric:redpanda_kafka_request_latency_seconds_sum
      type: gauge
    - key: redpanda.kafka.request.latency.seconds.count
      value: metric:redpanda_kafka_request_latency_seconds_count
      type: gauge
  - subgroup: rpc_request_latency
    dimensions:
    - key: redpanda_server
      value: label:redpanda_server
    metrics:
    - key: redpanda.rpc.request.latency.seconds.sum
      value: metric:redpanda_rpc_request_latency_seconds_sum
      type: gauge
    - key: redpanda.rpc.request.latency.seconds.count
      value: metric:redpanda_rpc_request_latency_seconds_count
      type: gauge
- group: io_performance
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  - key: shard
    value: label:shard
  metrics:
  - key: redpanda.io.queue.read.ops.total
    value: metric:redpanda_io_queue_total_read_ops
    type: count
  - key: redpanda.io.queue.write.ops.total
    value: metric:redpanda_io_queue_total_write_ops
    type: count
- group: partition_health
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  metrics:
  - key: redpanda.kafka.under_replicated_replicas
    value: metric:redpanda_kafka_under_replicated_replicas
    type: gauge
  - key: redpanda.cluster.unavailable_partitions
    value: metric:redpanda_cluster_unavailable_partitions
    type: gauge
  - key: redpanda.raft.leadership.changes
    value: metric:redpanda_raft_leadership_changes
    type: count
  - key: redpanda.node.status.rpcs_timed_out
    value: metric:redpanda_node_status_rpcs_timed_out
    type: count
- group: throughput
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  - key: redpanda_server
    value: label:redpanda_server
  metrics:
  - key: redpanda.rpc.received.bytes
    value: metric:redpanda_rpc_received_bytes
    type: count
  - key: redpanda.rpc.sent.bytes
    value: metric:redpanda_rpc_sent_bytes
    type: count
- group: infrastructure
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  subgroups:
  - subgroup: cpu_metrics
    metrics:
    - key: redpanda.cpu.busy.seconds.total
      value: metric:redpanda_cpu_busy_seconds_total
      type: count
    - key: redpanda.uptime.seconds.total
      value: metric:redpanda_application_uptime_seconds_total
      type: gauge
  - subgroup: memory_metrics
    metrics:
    - key: redpanda.memory.available.bytes
      value: metric:redpanda_memory_available_memory
      type: gauge
    - key: redpanda.memory.free.bytes
      value: metric:redpanda_memory_free_memory
      type: gauge
    - key: redpanda.memory.allocated.bytes
      value: metric:redpanda_memory_allocated_memory
      type: gauge
  - subgroup: disk_metrics
    dimensions:
    - key: shard
      value: label:shard
    metrics:
    - key: redpanda.storage.disk.free.bytes
      value: metric:redpanda_storage_disk_free_bytes
      type: gauge
    - key: redpanda.storage.disk.total.bytes
      value: metric:redpanda_storage_disk_total_bytes
      type: gauge
    - key: redpanda.storage.disk.free_space_alert
      value: metric:redpanda_storage_disk_free_space_alert
      type: gauge
- group: service_errors
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  metrics:
  - key: redpanda.schema_registry.request.errors.total
    value: metric:redpanda_schema_registry_request_errors_total
    type: count
  - key: redpanda.rest_proxy.request.errors.total
    value: metric:redpanda_rest_proxy_request_errors_total
    type: count
- group: consumer_groups
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  - key: redpanda_group
    value: label:redpanda_group
  - key: redpanda_topic
    value: label:redpanda_topic
  - key: redpanda_partition
    value: label:redpanda_partition
  metrics:
  - key: redpanda.kafka.consumer_group.lag.max
    value: metric:redpanda_kafka_consumer_group_lag_max
    type: gauge
  - key: redpanda.kafka.consumer_group.lag.sum
    value: metric:redpanda_kafka_consumer_group_lag_sum
    type: gauge
  - key: redpanda.kafka.consumer_group.committed_offset
    value: metric:redpanda_kafka_consumer_group_committed_offset
    type: gauge
- group: topics_partitions
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  - key: redpanda_namespace
    value: label:redpanda_namespace
  - key: redpanda_topic
    value: label:redpanda_topic
  - key: redpanda_partition
    value: label:redpanda_partition
  metrics:
  - key: redpanda.kafka.request.bytes.total
    value: metric:redpanda_kafka_request_bytes_total
    type: count
- group: rpc_connections
  interval:
    minutes: 1
  dimensions:
  - key: redpanda_cluster
    value: label:redpanda_cluster
  - key: redpanda_server
    value: label:redpanda_server
  metrics:
  - key: redpanda.rpc.active_connections
    value: metric:redpanda_rpc_active_connections
    type: gauge
metrics:
- key: redpanda.kafka.request.latency.seconds.sum
  metadata:
    displayName: Kafka Request Latency Sum
    description: Sum of Kafka request latencies (use with count to calculate average)
    unit: Second
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.kafka.request.latency.seconds.count
  metadata:
    displayName: Kafka Request Latency Count
    description: Number of Kafka requests (use with sum to calculate average)
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.rpc.request.latency.seconds.sum
  metadata:
    displayName: Internal RPC Latency Sum
    description: Sum of internal RPC latencies between brokers
    unit: Second
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.rpc.request.latency.seconds.count
  metadata:
    displayName: Internal RPC Latency Count
    description: Number of internal RPC requests
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.io.queue.read.ops.total
  metadata:
    displayName: I/O Read Operations
    description: Total read operations - indicates disk read load
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: false
      valueType: unknown
- key: redpanda.io.queue.write.ops.total
  metadata:
    displayName: I/O Write Operations
    description: Total write operations - indicates disk write load
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: false
      valueType: unknown
- key: redpanda.kafka.under_replicated_replicas
  metadata:
    displayName: Under-Replicated Replicas
    description: Partitions not fully replicated - DATA LOSS RISK
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.cluster.unavailable_partitions
  metadata:
    displayName: Unavailable Partitions
    description: Partitions without a leader - CANNOT SERVE REQUESTS
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.raft.leadership.changes
  metadata:
    displayName: Leadership Changes
    description: Raft leadership transfers - indicates cluster instability
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: false
      valueType: unknown
- key: redpanda.node.status.rpcs_timed_out
  metadata:
    displayName: Node RPC Timeouts
    description: Status RPC timeouts to peer nodes - connectivity issues
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.rpc.received.bytes
  metadata:
    displayName: Producer Throughput
    description: Total bytes received from producers
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: false
      impactRelevant: false
      valueType: unknown
- key: redpanda.rpc.sent.bytes
  metadata:
    displayName: Consumer Throughput
    description: Total bytes sent to consumers
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: false
      impactRelevant: false
      valueType: unknown
- key: redpanda.cpu.busy.seconds.total
  metadata:
    displayName: CPU Busy Time
    description: Total CPU non-idle time
    unit: Second
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: false
      valueType: unknown
- key: redpanda.uptime.seconds.total
  metadata:
    displayName: Uptime
    description: Total broker uptime
    unit: Second
    metricProperties:
      minValue: 0
      rootCauseRelevant: false
      impactRelevant: false
      valueType: unknown
- key: redpanda.memory.available.bytes
  metadata:
    displayName: Available Memory
    description: Available memory including reclaimable cache
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.memory.free.bytes
  metadata:
    displayName: Free Memory
    description: Free memory only
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.memory.allocated.bytes
  metadata:
    displayName: Allocated Memory
    description: Memory allocated by Redpanda
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: false
      valueType: unknown
- key: redpanda.storage.disk.free.bytes
  metadata:
    displayName: Disk Free Space
    description: Available disk space
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.storage.disk.total.bytes
  metadata:
    displayName: Disk Total Space
    description: Total disk space
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: false
      impactRelevant: false
      valueType: unknown
- key: redpanda.storage.disk.free_space_alert
  metadata:
    displayName: Disk Space Alert
    description: Disk space critically low indicator
    unit: Count
    metricProperties:
      minValue: 0
      maxValue: 1
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.schema_registry.request.errors.total
  metadata:
    displayName: Schema Registry Errors
    description: Total Schema Registry request errors
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.rest_proxy.request.errors.total
  metadata:
    displayName: REST Proxy Errors
    description: Total REST Proxy request errors
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.kafka.consumer_group.lag.max
  metadata:
    displayName: Consumer Group Max Lag
    description: Maximum consumer lag across partitions
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.kafka.consumer_group.lag.sum
  metadata:
    displayName: Consumer Group Total Lag
    description: Total consumer lag across all partitions
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: true
      impactRelevant: true
      valueType: unknown
- key: redpanda.kafka.consumer_group.committed_offset
  metadata:
    displayName: Consumer Group Committed Offset
    description: Last committed offset for consumer group
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: false
      impactRelevant: false
      valueType: unknown
- key: redpanda.kafka.request.bytes.total
  metadata:
    displayName: Topic Request Bytes
    description: Total request bytes by topic
    unit: Byte
    metricProperties:
      minValue: 0
      rootCauseRelevant: false
      impactRelevant: false
      valueType: unknown
- key: redpanda.rpc.active_connections
  metadata:
    displayName: Active RPC Connections
    description: Number of active RPC connections
    unit: Count
    metricProperties:
      minValue: 0
      rootCauseRelevant: false
      impactRelevant: false
      valueType: unknown
